# From Fedora:
#
# Node's v8 breaks with GCC 6 because of incorrect usage of methods on
# NULL objects. We need to pass -fno-delete-null-pointer-checks
abinfo "(Fedora) Appending flags to avoid runtime issues with binaries generated by GCC 6+ ..."
export CFLAGS="${CFLAGS} -g -D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=64 -fno-delete-null-pointer-checks"
export CXXFLAGS="${CXXFLAGS} -g -D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=64 -fno-delete-null-pointer-checks"

if ab_match_arch armv7hf; then
    abinfo "ARMv7hf detected, appending NEON as FPU ..."
    NODEARCHCONFOPTIONS="--with-arm-fpu=neon"
fi

if ab_match_arch loongson3; then
    abinfo "Loongson 3 detected, specifying r2 target and fp64 FPU mode ..."
    MIPS64CONF="--with-mips-arch-variant=r2 --with-mips-fpu-mode=fp64"
elif ab_match_arch mips64r6el; then
    abinfo "MIPS64r6 detected, specifying r6 target ..."
    MIPS64CONF="--with-mips-arch-variant=r6"
fi
