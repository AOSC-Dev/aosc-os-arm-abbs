abinfo "Enabling Rust backtrace ..."
export RUST_BACKTRACE=1

abinfo "Setting RUST_COMPILER_RT_ROOT ..."
export RUST_COMPILER_RT_ROOT="$SRCDIR"/compiler-rt-$LLVMVER.src

abinfo "Building Rustc ..."
python3 "$SRCDIR"/x.py dist \
    -j "$(nproc)"

abinfo "Installing Rustc ..."
DESTDIR="$PKGDIR" \
    python3 "$SRCDIR"/x.py install \
        -j "$(nproc)"

abinfo "Arch Linux: Deleting unnecesary files, e.g. components and manifest files only used for the uninstall script..."
(
    cd "$PKGDIR"/usr/lib/rustlib
    rm -v \
        components \
        install.log \
        manifest-* \
        rust-installer-version \
        uninstall.sh
)
