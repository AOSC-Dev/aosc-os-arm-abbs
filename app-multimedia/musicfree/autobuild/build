abinfo "Installing Dependencies ..."
npm install 

abinfo "Removing Update Data ..."
sed -i 's/version.json/version.json0/g' "$SRCDIR"/src/main/ipc/index.ts

abinfo "Building MusicFree ..."
if ab_match_arch arm64; then
	ELECTRONDIR="$SRCDIR"/out/MusicFree-linux-arm64
	abinfo " Building MusicFree For arm64 ..."
	npm run package --arch="arm64"
else
	ELECTRONDIR="$SRCDIR"/out/MusicFree-linux-x64
	abinfo " Building MusicFree For amd64 ..."
	npm run package --arch="amd64"
fi

abinfo "Installing MusicFree ..."
mkdir -pv "$PKGDIR"/usr/lib/musicfree
cp -av "$ELECTRONDIR"/* "$PKGDIR"/usr/lib/musicfree/
chmod -v 755 "$PKGDIR"/usr/lib/musicfree/MusicFree
mkdir -pv "$PKGDIR"/usr/share/doc/musicfree
cp -v "$ELECTRONDIR"/*LICENSE* "$PKGDIR"/usr/share/doc/musicfree

abinfo "Marking any shared libraries as executable ..."
find "$PKGDIR" -name '*.so.*' -exec chmod -v 0755 {} \;
