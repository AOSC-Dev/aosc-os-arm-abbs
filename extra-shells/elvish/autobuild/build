# FIXME: -pie and -r are incompatible error during `go get`.
# export CGO_ENABLED=1 \
#       CGO_CFLAGS="${CFLAGS}" \
#       CGO_CPPFLAGS="${CPPFLAGS}" \
#       CGO_CXXFLAGS="${CXXFLAGS}" \
#       CGO_LDFLAGS="${LDFLAGS}"

export GOPATH="$SRCDIR"
mkdir -p "$SRCDIR"/src/github.com/elves
ln -s "$SRCDIR"/elvish-$PKGVER "$SRCDIR"/src/github.com/elves/elvish

cd "$GOPATH"/src/github.com/elves/elvish
make get stub
cd "$SRCDIR"

mkdir -p "$PKGDIR"/usr/bin
cp -a "$GOPATH"/bin/elvish* "$PKGDIR"/usr/bin/
