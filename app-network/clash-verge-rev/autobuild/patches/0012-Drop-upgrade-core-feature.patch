From d964e765d55e37b13103bc5ad5ed42da827392d0 Mon Sep 17 00:00:00 2001
From: eatradish <sakiiily@aosc.io>
Date: Wed, 29 May 2024 23:08:12 +0800
Subject: [PATCH] Drop upgrade core feature

---
 .../setting/mods/clash-core-viewer.tsx        | 32 ++++---------------
 src/services/api.ts                           |  6 ----
 2 files changed, 7 insertions(+), 31 deletions(-)

diff --git a/src/components/setting/mods/clash-core-viewer.tsx b/src/components/setting/mods/clash-core-viewer.tsx
index 4a14242..1dda97a 100644
--- a/src/components/setting/mods/clash-core-viewer.tsx
+++ b/src/components/setting/mods/clash-core-viewer.tsx
@@ -15,7 +15,7 @@ import {
   ListItemText,
 } from "@mui/material";
 import { changeClashCore, restartSidecar } from "@/services/cmds";
-import { closeAllConnections, upgradeCore } from "@/services/api";
+import { closeAllConnections } from "@/services/api";
 import { grantPermission } from "@/services/cmds";
 import getSystem from "@/utils/get-system";
 
@@ -60,7 +60,12 @@ export const ClashCoreViewer = forwardRef<DialogRef>((props, ref) => {
       await grantPermission(core);
       // 自动重启
       if (core === clash_core) await restartSidecar();
-      Notice.success(t("Permissions Granted Successfully for _clash Core", { core: `${core}` }), 1000);
+      Notice.success(
+        t("Permissions Granted Successfully for _clash Core", {
+          core: `${core}`,
+        }),
+        1000
+      );
     } catch (err: any) {
       Notice.error(err?.message || err.toString());
     }
@@ -75,18 +80,6 @@ export const ClashCoreViewer = forwardRef<DialogRef>((props, ref) => {
     }
   });
 
-  const onUpgrade = useLockFn(async () => {
-    try {
-      setUpgrading(true);
-      await upgradeCore();
-      setUpgrading(false);
-      Notice.success(t(`Core Version Updated`), 1000);
-    } catch (err: any) {
-      setUpgrading(false);
-      Notice.error(err?.response.data.message || err.toString());
-    }
-  });
-
   return (
     <BaseDialog
       open={open}
@@ -94,17 +87,6 @@ export const ClashCoreViewer = forwardRef<DialogRef>((props, ref) => {
         <Box display="flex" justifyContent="space-between">
           {t("Clash Core")}
           <Box>
-            <LoadingButton
-              variant="contained"
-              size="small"
-              startIcon={<SwitchAccessShortcut />}
-              loadingPosition="start"
-              loading={upgrading}
-              sx={{ marginRight: "8px" }}
-              onClick={onUpgrade}
-            >
-              {t("Upgrade")}
-            </LoadingButton>
             <Button
               variant="contained"
               size="small"
diff --git a/src/services/api.ts b/src/services/api.ts
index bded6e3..994f95f 100644
--- a/src/services/api.ts
+++ b/src/services/api.ts
@@ -61,12 +61,6 @@ export const updateGeoData = async () => {
   return instance.post("/configs/geo");
 };
 
-/// Upgrade clash core
-export const upgradeCore = async () => {
-  const instance = await getAxios();
-  return instance.post("/upgrade");
-};
-
 /// Get current rules
 export const getRules = async () => {
   const instance = await getAxios();
-- 
2.45.1

