Description: CVE-2017-5854
Acked-By: Markus Koschany <apo@debian.org>
Acked-By: Mattia Rizzolo <mattia@debian.org>
Last-Update: 2017-05-03
Bug-Debian: https://bugs.debian.org/854602
Origin: https://sourceforge.net/p/podofo/code/1836

--- a/tools/podofopdfinfo/pdfinfo.cpp
+++ b/tools/podofopdfinfo/pdfinfo.cpp
@@ -207,6 +207,10 @@
 	for ( int pg=0; pg<pgCount; pg++ ) 
 	{
 		curPage = mDoc->GetPage( pg );
+		if( !curPage )
+		{
+			PODOFO_RAISE_ERROR( PoDoFo::ePdfError_PageNotFound );
+		}
 		rect = curPage->GetMediaBox();
 		Format s( rect.GetWidth() - rect.GetLeft(), rect.GetHeight() - rect.GetBottom());
 		sIt = sizes.find(s);
