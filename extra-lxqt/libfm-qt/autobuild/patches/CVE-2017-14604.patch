From 956663ba85219166f39314a2852e1afda8815dde Mon Sep 17 00:00:00 2001
From: Tsu Jan <tsujan2000@gmail.com>
Date: Wed, 1 Feb 2017 04:39:22 +0330
Subject: [PATCH] Confirmation dialog for desktop files

This PR follows https://github.com/lxde/libfm/pull/21. It provides an appropriate confirmation dialog for desktop files, with a slightly different text and without the "Execute in Terminal" button.
---
 src/execfiledialog.cpp | 8 +++++++-
 1 file changed, 7 insertions(+), 1 deletion(-)

diff --git a/src/execfiledialog.cpp b/src/execfiledialog.cpp
index 3759d0b..1304df3 100644
--- a/src/execfiledialog.cpp
+++ b/src/execfiledialog.cpp
@@ -35,7 +35,13 @@ ExecFileDialog::ExecFileDialog(FmFileInfo* file, QWidget* parent, Qt::WindowFlag
   ui->icon->setPixmap(IconTheme::icon(icon).pixmap(QSize(48, 48)));
 
   QString msg;
-  if(fm_file_info_is_text(file)) {
+  if(fm_file_info_is_desktop_entry(file)) {
+    msg = tr("This file '%1' seems to be a desktop entry.\nWhat do you want to do with it?")
+            .arg(QString::fromUtf8(fm_file_info_get_disp_name(file)));
+    ui->exec->setDefault(true);
+    ui->execTerm->hide();
+  }
+  else if(fm_file_info_is_text(file)) {
     msg = tr("This text file '%1' seems to be an executable script.\nWhat do you want to do with it?")
             .arg(QString::fromUtf8(fm_file_info_get_disp_name(file)));
     ui->execTerm->setDefault(true);
