From c94066f10aa8ad4285c2f87b09c2c85b7869df72 Mon Sep 17 00:00:00 2001
From: renchenglei <chenglei.ren@intel.com>
Date: Tue, 8 Dec 2020 04:15:44 +0000
Subject: [PATCH] Changes in code.

---
 IGC/Compiler/MetaDataApi/MetaDataValue.h | 8 ++++----
 visa/iga/include/common/secure_mem.h     | 5 +++++
 visa/iga/include/common/secure_string.h  | 6 ++++++
 3 files changed, 15 insertions(+), 4 deletions(-)

diff --git a/IGC/Compiler/MetaDataApi/MetaDataValue.h b/IGC/Compiler/MetaDataApi/MetaDataValue.h
index f3dab15e..3005673e 100644
--- a/IGC/Compiler/MetaDataApi/MetaDataValue.h
+++ b/IGC/Compiler/MetaDataApi/MetaDataValue.h
@@ -79,7 +79,7 @@ namespace IGC
 
         llvm::MDNode* getMDNode()
         {
-            return m_pNode;
+            return (llvm::MDNode*)m_pNode;
         }
 
         void set(const value_type& val)
@@ -257,7 +257,7 @@ namespace IGC
 
         NamedMetaDataValue& operator=(llvm::Value* pNode)
         {
-            m_pNode = pNode;
+            m_pNode = (llvm::Metadata*)pNode;
             m_id = getIdNode(pNode);
             m_value = getValueNode(pNode);
 
@@ -267,7 +267,7 @@ namespace IGC
         NamedMetaDataValue& operator=(const char* name)
         {
             m_pNode = NULL;
-            m_id = name;
+            m_id = std::string(name);
 
             return *this;
         }
@@ -275,7 +275,7 @@ namespace IGC
         NamedMetaDataValue& operator=(std::string name)
         {
             m_pNode = NULL;
-            m_id = name.c_str();
+            m_id = name;
 
             return *this;
         }
diff --git a/visa/iga/include/common/secure_mem.h b/visa/iga/include/common/secure_mem.h
index f44db2be..95628ccd 100644
--- a/visa/iga/include/common/secure_mem.h
+++ b/visa/iga/include/common/secure_mem.h
@@ -25,6 +25,9 @@ SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 ======================= end_copyright_notice ==================================*/
 #pragma once
 
+#ifndef SECURE_MEM_H
+#define SECURE_MEM_H
+
 #if ((!defined _WIN32) && ( !defined __STDC_LIB_EXT1__ ))
 
 #include <errno.h>
@@ -61,3 +64,5 @@ inline errno_t fopen_s( FILE** pFile, const char* filename, const char *mode )
 }
 
 #endif
+
+#endif
diff --git a/visa/iga/include/common/secure_string.h b/visa/iga/include/common/secure_string.h
index 66d8ad3d..f9a51ef4 100644
--- a/visa/iga/include/common/secure_string.h
+++ b/visa/iga/include/common/secure_string.h
@@ -24,6 +24,10 @@ SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 
 ======================= end_copyright_notice ==================================*/
 #pragma once
+
+#ifndef SECURE_STRING_H
+#define SECURE_STRING_H
+
 #if ((!defined _WIN32) && ( !defined __STDC_LIB_EXT1__ ))
 
 #include <stdlib.h>
@@ -132,3 +136,5 @@ _snprintf_s(char *buffer, size_t sizeOfBuffer, size_t count, const char *format,
 }
 
 #endif
+
+#endif
