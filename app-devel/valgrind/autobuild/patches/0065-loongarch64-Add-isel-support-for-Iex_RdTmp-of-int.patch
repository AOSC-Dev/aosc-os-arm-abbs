From 81e604c650bb5f1d4cfc5e4a8bddd221fe90bb98 Mon Sep 17 00:00:00 2001
From: Feiyang Chen <chenfeiyang@loongson.cn>
Date: Tue, 22 Mar 2022 15:03:52 +0800
Subject: [PATCH v4 065/123] loongarch64: Add isel support for Iex_RdTmp of
 integer expressions (128 bit)

---
 VEX/priv/host_loongarch64_isel.c | 21 +++++++++++++++++++++
 1 file changed, 21 insertions(+)

diff --git a/VEX/priv/host_loongarch64_isel.c b/VEX/priv/host_loongarch64_isel.c
index 3e37de23a..9e5b95e4a 100644
--- a/VEX/priv/host_loongarch64_isel.c
+++ b/VEX/priv/host_loongarch64_isel.c
@@ -1465,6 +1465,27 @@ static void iselInt128Expr (HReg* hi, HReg* lo, ISelEnv* env, IRExpr* e)
 /* DO NOT CALL THIS DIRECTLY ! */
 static void iselInt128Expr_wrk (HReg* hi, HReg* lo, ISelEnv* env, IRExpr* e)
 {
+   vassert(e);
+   vassert(typeOfIRExpr(env->type_env, e) == Ity_I128);
+
+   /* --------- TEMP --------- */
+   if (e->tag == Iex_RdTmp) {
+      lookupIRTempPair(hi, lo, env, e->Iex.RdTmp.tmp);
+      return;
+   }
+
+   /* --------- BINARY OP --------- */
+   if (e->tag == Iex_Binop) {
+      switch (e->Iex.Binop.op) {
+         default:
+            goto irreducible;
+      }
+   }
+
+   /* We get here if no pattern matched. */
+irreducible:
+   ppIRExpr(e);
+   vpanic("iselInt128Expr(loongarch64): cannot reduce tree");
 }
 
 
-- 
2.39.1

