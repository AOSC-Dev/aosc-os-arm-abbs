diff -Naur a/doc/spec.txt b/doc/spec.txt
--- a/doc/spec.txt	2017-03-07 14:53:20.000000000 -0600
+++ b/doc/spec.txt	2017-10-03 22:35:05.909166337 -0500
@@ -4060,7 +4060,8 @@
     -bh, the protocol is forced to one of the standard SMTP protocol names (see
     the description of $received_protocol in section 11.9). For -bs, the
     protocol is always "local-" followed by one of those same names. For -bS
-    (batched SMTP) however, the protocol can be set by -oMr.
+    (batched SMTP) however, the protocol can be set by -oMr. Repeated use of
+    this option is not supported.
 
 -oMs <host name>
 
diff -Naur a/src/exim.c b/src/exim.c
--- a/src/exim.c	2017-03-04 15:21:35.000000000 -0600
+++ b/src/exim.c	2017-10-03 22:36:15.279352507 -0500
@@ -3092,7 +3092,14 @@
 
       /* -oMr: Received protocol */
 
-      else if (Ustrcmp(argrest, "Mr") == 0) received_protocol = argv[++i];
+      else if (Ustrcmp(argrest, "Mr") == 0)
+
+        if (received_protocol)
+          {
+          fprintf(stderr, "received_protocol is set already\n");
+          exit(EXIT_FAILURE);
+          }
+        else received_protocol = argv[++i];
 
       /* -oMs: Set sender host name */
 
@@ -3188,7 +3195,15 @@
 
     if (*argrest != 0)
       {
-      uschar *hn = Ustrchr(argrest, ':');
+      uschar *hn;
+
+      if (received_protocol)
+        {
+        fprintf(stderr, "received_protocol is set already\n");
+        exit(EXIT_FAILURE);
+        }
+
+      hn = Ustrchr(argrest, ':');
       if (hn == NULL)
         {
         received_protocol = argrest;
