mkdir wide-build build

pushd wide-build
../configure --host=armv7a-hardfloat-linux-gnueabi --prefix=/usr --mandir=/usr/share/man \
             --with-shared --with-normal --without-debug --without-ada \
             --enable-widec --enable-pc-files --with-cxx-binding --with-cxx-shared
make $ABMK
make install DESTDIR=`pwd`/../abdist
popd

cp -r abdist/lib abdist/usr/
rm -rf abdist/lib


for lib in ncurses ncurses++ form panel menu; do
    echo "INPUT(-l${lib}w)" > abdist/usr/lib/lib${lib}.so
done


for lib in ncurses ncurses++ form panel menu; do
    ln -s ${lib}w.pc abdist/usr/lib/pkgconfig/${lib}.pc
done


echo "INPUT(-lncursesw)" > abdist/usr/lib/libcursesw.so
ln -s libncurses.so abdist/usr/lib/libcurses.so


pushd build
../configure --host=armv7a-hardfloat-linux-gnueabi --prefix=/usr \
             --with-shared --with-normal --without-debug --without-ada \
             --with-chtype=long \
             --with-cxx-binding --with-cxx-shared
make $ABMK

for lib in ncurses form panel menu; do
    install -Dm755 lib/lib${lib}.so.5.9 ../abdist/usr/lib/lib${lib}.so.5.9
    ln -s lib${lib}.so.5.9 ../abdist/usr/lib/lib${lib}.so.5
done

popd

# FreeBasic compatibility.
pushd abdist/usr/lib
ln -sv libncursesw.so.5.9 libtinfo.so.5.9
ln -sv libtinfo.so.5.9 libtinfo.so.5
ln -sv libtinfo.so.5 libtinfo.so
popd
