PKGNAME=stepmania
PKGSEC=games
PKGDEP="alsa-lib glew gtk-3 jsoncpp libjpeg-turbo libmad libtomcrypt \
        libtommath libvorbis mesa pulseaudio zlib"
BUILDDEP="pkg-config yasm"
PKGDES="An advanced rhythm game designed for both home and arcade use cases"

CMAKE_AFTER="-DWITH_SYSTEM_FFMPEG=OFF \
             -DWITH_SYSTEM_JPEG=ON \
             -DWITH_SYSTEM_GLEW=ON \
             -DWITH_SYSTEM_ZLIB=ON \
             -DWITH_SYSTEM_PCRE=ON \
             -DWITH_SYSTEM_MAD=ON \
             -DWITH_SYSTEM_OGG=ON \
             -DWITH_SYSTEM_PNG=ON \
             -DWITH_SYSTEM_JSONCPP=ON \
             -DWITH_SYSTEM_TOMMATH=ON \
             -DWITH_SYSTEM_TOMCRYPT=ON \
             -DWITH_CRYSTALHD_DISABLED=ON \
             -DCMAKE_POSITION_INDEPENDENT_CODE=ON \
             -DWITH_MINIMAID=OFF"
CMAKE_AFTER__AMD64=" \
             ${CMAKE_AFTER} \
             -DWITH_MINIMAID=ON"

# FIXME: CMake Error at CMake/SetupFfmpeg.cmake:2 (message):
#          You cannot use the Ninja generator when building the bundled ffmpeg
#          library.
ABTYPE=cmake

# FIXME: LTO breaks bundled FFmpeg linkage.
NOLTO=1

PKGEPOCH=1

FAIL_ARCH="!(amd64|arm64|ppc64el)"
