From eab1911c565d49220ee9b2e8e6cfc831a169a85a Mon Sep 17 00:00:00 2001
From: Kexy Biscuit <kexybiscuit@aosc.io>
Date: Wed, 7 Aug 2024 00:27:44 +0800
Subject: [PATCH 31/31] [AOSC] Setting code model to large on AMD64 to avoid
 relocation out of range.

---
 build/rust/rust_target.gni | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/build/rust/rust_target.gni b/build/rust/rust_target.gni
index 30e15f1b49..a4a514267b 100644
--- a/build/rust/rust_target.gni
+++ b/build/rust/rust_target.gni
@@ -400,6 +400,9 @@ template("rust_target") {
       if (current_cpu == "loong64") {
         rustflags += [ "-Ccode-model=medium" ]
       }
+      if (current_cpu == "x64") {
+        rustflags += [ "-Ccode-model=large" ]
+      }
       rustenv = _rustenv
 
       if (_generate_crate_root) {
-- 
2.46.0

